function [T, P2P2, P2xP2x, P2xP2y, P2yP2y, P2xP1, P2yP1, P1xP1x, P1xP1y, P1yP1y, P2P2xP2, P2P2yP2, P2P2P2x, P2P2P2y, P2P2P2s, P2P2xP2nG, P2P2yP2nG] = init_feaspace
syms lambda1 lambda2 lambda3 x1 x2 x3 y1 y2 y3 real
xi1 = x2 - x3;
xi2 = x3 - x1;
xi3 = x1 - x2;
eta1 = y2 - y3;
eta2 = y3 - y1;
eta3 = y1 - y2;
inner11 = eta1^2 + xi1^2;
inner12 = eta1 * eta2 + xi1 * xi2;
inner13 = eta1 * eta3 + xi1 * xi3;
T2 = det([1, x1, y1; 1, x2, y2; 1, x3, y3]);
P2 = [
    lambda1 * (2 * lambda1 - 1);
    lambda2 * (2 * lambda2 - 1);
    lambda3 * (2 * lambda3 - 1);
    4 * lambda2 * lambda3;
    4 * lambda3 * lambda1;
    4 * lambda1 * lambda2;
];
lambda1x = eta1 / T2;
lambda2x = eta2 / T2;
lambda3x = eta3 / T2;
lambda1y = -xi1 / T2;
lambda2y = -xi2 / T2;
lambda3y = -xi3 / T2;
lambda1n = -sqrt(inner11) / T2;
lambda2n = -inner12/sqrt(inner11)/T2;
lambda3n = -inner13/sqrt(inner11)/T2;
P2_1 = diff(P2, lambda1);
P2_2 = diff(P2, lambda2);
P2_3 = diff(P2, lambda3);
P1 = [lambda1; lambda2; lambda3];
P2P2 = int(int(subs(P2*P2', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2_1P2_1 = int(int(subs(P2_1*P2_1', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2_1P2_2 = int(int(subs(P2_1*P2_2', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2_1P2_3 = int(int(subs(P2_1*P2_3', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2_2P2_2 = int(int(subs(P2_2*P2_2', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2_2P2_3 = int(int(subs(P2_2*P2_3', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2_3P2_3 = int(int(subs(P2_3*P2_3', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2_1P1 = int(int(subs(P2_1*P1', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2_2P1 = int(int(subs(P2_2*P1', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2_3P1 = int(int(subs(P2_3*P1', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2P2_1P2 = int(int(subs(reshape(P2*P2_1', [36, 1])*P2', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2P2_2P2 = int(int(subs(reshape(P2*P2_2', [36, 1])*P2', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2P2_3P2 = int(int(subs(reshape(P2*P2_3', [36, 1])*P2', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2P2P2_1 = int(int(subs(reshape(P2*P2', [36, 1])*P2_1', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2P2P2_2 = int(int(subs(reshape(P2*P2', [36, 1])*P2_2', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2P2P2_3 = int(int(subs(reshape(P2*P2', [36, 1])*P2_3', lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2P2P2s = int(int(subs(reshape(P2P2, [36, 1])*reshape(P2*P2', [1, 36]), lambda3, 1 - lambda1 - lambda2), lambda2, 0, 1 - lambda1), lambda1, 0, 1);
P2P2_1P2_1G = int(subs(reshape(P2*P2_1', [36, 1])*P2_1', {lambda1, lambda3}, {0, 1 - lambda2}), lambda2, 0, 1);
P2P2_1P2_2G = int(subs(reshape(P2*P2_1', [36, 1])*P2_2', {lambda1, lambda3}, {0, 1 - lambda2}), lambda2, 0, 1);
P2P2_1P2_3G = int(subs(reshape(P2*P2_1', [36, 1])*P2_3', {lambda1, lambda3}, {0, 1 - lambda2}), lambda2, 0, 1);
P2P2_2P2_1G = int(subs(reshape(P2*P2_2', [36, 1])*P2_1', {lambda1, lambda3}, {0, 1 - lambda2}), lambda2, 0, 1);
P2P2_2P2_2G = int(subs(reshape(P2*P2_2', [36, 1])*P2_2', {lambda1, lambda3}, {0, 1 - lambda2}), lambda2, 0, 1);
P2P2_2P2_3G = int(subs(reshape(P2*P2_2', [36, 1])*P2_3', {lambda1, lambda3}, {0, 1 - lambda2}), lambda2, 0, 1);
P2P2_3P2_1G = int(subs(reshape(P2*P2_3', [36, 1])*P2_1', {lambda1, lambda3}, {0, 1 - lambda2}), lambda2, 0, 1);
P2P2_3P2_2G = int(subs(reshape(P2*P2_3', [36, 1])*P2_2', {lambda1, lambda3}, {0, 1 - lambda2}), lambda2, 0, 1);
P2P2_3P2_3G = int(subs(reshape(P2*P2_3', [36, 1])*P2_3', {lambda1, lambda3}, {0, 1 - lambda2}), lambda2, 0, 1);

P2xP2x = lambda1x^2*P2_1P2_1 + lambda1x*lambda2x*(P2_1P2_2 + P2_1P2_2') + lambda1x*lambda3x*(P2_1P2_3 + P2_1P2_3') + lambda2x^2*P2_2P2_2 + lambda2x*lambda3x*(P2_2P2_3 + P2_2P2_3') + lambda3x^2*P2_3P2_3;
P2xP2y = lambda1x*lambda1y*P2_1P2_1 + lambda1x*lambda2y*P2_1P2_2 + lambda1x*lambda3y*P2_1P2_3 + lambda2x*lambda1y*P2_1P2_2' + lambda2x*lambda2y*P2_2P2_2 + lambda2x*lambda3y*P2_2P2_3 + lambda3x*lambda1y*P2_1P2_3' + lambda3x*lambda2y*P2_2P2_3' + lambda3x*lambda3y*P2_3P2_3;
P2yP2y = lambda1y^2*P2_1P2_1 + lambda1y*lambda2y*(P2_1P2_2 + P2_1P2_2') + lambda1y*lambda3y*(P2_1P2_3 + P2_1P2_3') + lambda2y^2*P2_2P2_2 + lambda2y*lambda3y*(P2_2P2_3 + P2_2P2_3') + lambda3y^2*P2_3P2_3;
P2xP1 = lambda1x*P2_1P1 + lambda2x*P2_2P1 + lambda3x*P2_3P1;
P2yP1 = lambda1y*P2_1P1 + lambda2y*P2_2P1 + lambda3y*P2_3P1;
P1xP1x = [lambda1x; lambda2x; lambda3x]*[lambda1x, lambda2x, lambda3x]/2;
P1xP1y = [lambda1x; lambda2x; lambda3x]*[lambda1y, lambda2y, lambda3y]/2;
P1yP1y = [lambda1y; lambda2y; lambda3y]*[lambda1y, lambda2y, lambda3y]/2;
P2P2xP2 = lambda1x*P2P2_1P2 + lambda2x*P2P2_2P2 + lambda3x*P2P2_3P2;
P2P2yP2 = lambda1y*P2P2_1P2 + lambda2y*P2P2_2P2 + lambda3y*P2P2_3P2;
P2P2P2x = lambda1x*P2P2P2_1 + lambda2x*P2P2P2_2 + lambda3x*P2P2P2_3;
P2P2P2y = lambda1y*P2P2P2_1 + lambda2y*P2P2P2_2 + lambda3y*P2P2P2_3;
P2P2xP2nG = lambda1x*lambda1n*P2P2_1P2_1G + lambda1x*lambda2n*P2P2_1P2_2G + lambda1x*lambda3n*P2P2_1P2_3G +lambda2x*lambda1n*P2P2_2P2_1G + lambda2x*lambda2n*P2P2_2P2_2G + lambda2x*lambda3n*P2P2_2P2_3G + lambda3x*lambda1n*P2P2_3P2_1G + lambda3x*lambda2n*P2P2_3P2_2G + lambda3x*lambda3n*P2P2_3P2_3G;
P2P2yP2nG = lambda1y*lambda1n*P2P2_1P2_1G + lambda1y*lambda2n*P2P2_1P2_2G + lambda1y*lambda3n*P2P2_1P2_3G +lambda2y*lambda1n*P2P2_2P2_1G + lambda2y*lambda2n*P2P2_2P2_2G + lambda2y*lambda3n*P2P2_2P2_3G + lambda3y*lambda1n*P2P2_3P2_1G + lambda3y*lambda2n*P2P2_3P2_2G + lambda3y*lambda3n*P2P2_3P2_3G;

P2P2 = matlabFunction(P2P2);
P2xP2x = matlabFunction(P2xP2x);
P2xP2y = matlabFunction(P2xP2y);
P2yP2y = matlabFunction(P2yP2y);
P2xP1 = matlabFunction(P2xP1);
P2yP1 = matlabFunction(P2yP1);
P1xP1x = matlabFunction(P1xP1x);
P1xP1y = matlabFunction(P1xP1y);
P1yP1y = matlabFunction(P1yP1y);
P2P2xP2 = matlabFunction(P2P2xP2);
P2P2yP2 = matlabFunction(P2P2yP2);
P2P2P2x = matlabFunction(P2P2P2x);
P2P2P2y = matlabFunction(P2P2P2y);
P2P2P2s = matlabFunction(P2P2P2s);
P2P2xP2nG = matlabFunction(P2P2xP2nG);
P2P2yP2nG = matlabFunction(P2P2yP2nG);
T = matlabFunction(T2);
end